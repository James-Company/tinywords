# docs/SSOT.md

TinyWords 프로젝트에서 **결정, 요구사항, 데이터 정의, UI 규칙, 프롬프트 규칙**이 흩어지지 않도록 “정답이 되는 문서 1곳”을 명확히 지정하기 위한 규칙 문서이다. 이 문서는 TinyWords 개발 과정 전반에서 **가장 우선되는 기준**이며, 구현·테스트·릴리즈·카피(소개 문구)까지 동일한 기준으로 정렬하는 역할을 한다.

---

## 1. SSOT의 목적

TinyWords의 핵심 가치가 “하루 적게 학습하되(3-5개), 완전히 내 것으로 만들기”라면, 프로젝트가 커질수록 다음 문제가 자주 발생한다.

* 기능 정의가 화면 문서와 구현에서 어긋나 UX가 흔들리는 문제
* AI 생성(단어·문장) 프롬프트가 분기되며 품질이 들쑥날쑥해지는 문제
* 복습 정책(간격 반복)과 스트릭 규칙이 여러 곳에서 다르게 계산되는 문제
* 플랫폼(iOS·iPadOS·Android·macOS) 제약이 뒤늦게 드러나 재작업이 커지는 문제

SSOT는 위 문제를 예방하기 위해 아래를 보장한다.

* **정의는 1곳에만 존재**한다.
* 변경은 **문서 → 테스트 → 코드** 순서로 반영한다.
* 논쟁이 생기면 **SSOT 문서에 기록된 내용이 정답**이다.

---

## 2. SSOT의 범위

SSOT는 다음 영역을 포함한다.

* 제품 목표 및 사용자 약속(What/Why)
* MVP 범위 및 후순위 범위(What not)
* 화면 스펙(입력/출력/상태/에러)
* 데이터 모델(엔티티, 관계, 제약)
* 학습 정책(하루 개수 3-5, 복습 주기, 회상 단계)
* 스트릭 규칙(성공 조건, 예외, 리셋 조건)
* AI 생성 정책(단어 생성, 문장 코칭 프롬프트)
* 음성 녹음 및 발음 점수 정의(지표, UX)
* API 계약(요청/응답, 에러 규격)
* 보안 및 개인정보(키 보호, 데이터 보존)
* UI 스타일(노트/수첩 테마, 타이포, 컴포넌트 규칙)
* 멀티플랫폼 패키징 정책(웹 기반, 스토어 배포)
* 국제화/현지화(i18n/l10n) 정책(로케일, 번역 키, 포맷 규칙)

SSOT는 아래를 포함하지 않는다.

* 세부 구현 코드(코드는 SSOT를 따르는 결과물이다)
* 개인 개발 환경 설정(로컬 .env, IDE 설정 등)

---

## 3. SSOT 문서 체계

SSOT는 “최상위 결정 문서”와 “영역별 SSOT 문서”로 구성된다.

### 3.1 최상위 SSOT

* 이 문서(`prompts/SSOT.md`)는 SSOT 규칙 자체, 문서 우선순위, 변경 절차를 정의한다.

### 3.2 영역별 SSOT(프롬프트 문서)

`prompts/` 폴더의 각 문서는 해당 영역의 SSOT이다.

* 제품: `01_PRODUCT_VISION.md`, `02_MVP_SCOPE.md`
* 플로우: `03_USER_FLOWS.md`
* 데이터: `04_DATA_MODEL.md`
* 화면: `05_SCREEN_SPEC_TODAY.md`, `06_SCREEN_SPEC_INBOX.md`, `07_SCREEN_SPEC_HISTORY.md`, `08_SCREEN_SPEC_SETTINGS.md`
* 학습 정책: `11_SPACED_REVIEW_POLICY.md`, `12_STREAK_RULES.md`
* AI: `09_AI_WORD_GENERATION_PROMPT.md`, `10_AI_SENTENCE_COACH_PROMPT.md`
* 음성/발음: `13_AUDIO_RECORDING_SPEC.md`, `14_PRONUNCIATION_SCORING_SPEC.md`
* API: `15_API_CONTRACT.md`
* 보안: `16_SECURITY_PRIVACY_KEYS.md`
* UI: `17_UI_STYLE_NOTEBOOK_THEME.md`
* 패키징: `18_PLATFORM_PACKAGING.md`
* 테스트/릴리즈: `19_TEST_PLAN.md`, `20_RELEASE_CHECKLIST.md`
* i18n: `21_I18N_LOCALIZATION.md`

---

## 4. 우선순위 규칙(충돌 시 결정 기준)

문서, 코드, 화면, 카피가 충돌할 때는 아래 우선순위를 따른다.

1. `prompts/SSOT.md`
2. `prompts/02_MVP_SCOPE.md`
3. `prompts/03_USER_FLOWS.md`
4. `prompts/04_DATA_MODEL.md`
5. `prompts/05-08_SCREEN_SPEC_*.md`
6. `prompts/11_SPACED_REVIEW_POLICY.md` 및 `prompts/12_STREAK_RULES.md`
7. `prompts/15_API_CONTRACT.md`
8. 구현 코드(웹 앱, 서버)
9. 테스트 코드(테스트는 문서를 검증하며, 문서가 바뀌면 테스트도 바뀌어야 한다)

예시는 아래와 같다.

* 스트릭 유지 조건이 화면 문서와 코드에서 다르면 `12_STREAK_RULES.md`의 정의가 정답이다.
* 복습 주기(D-1, D-3, D-7)가 프롬프트와 구현에서 다르면 `11_SPACED_REVIEW_POLICY.md`의 정의가 정답이다.

---

## 5. 변경 관리

TinyWords는 “작은 루틴을 흔들리지 않게” 제공하는 제품이다. 따라서 핵심 규칙 변경은 반드시 기록되어야 한다.

### 5.1 변경 원칙

* 변경은 **이유-영향-대안-결론** 형태로 기록하는 것이 원칙이다.
* 핵심 약속(하루 3-5개, 회상 중심, 복습 우선)은 쉽게 흔들지 않는 것이 원칙이다.
* 기능 추가가 생기면 먼저 **정의**를 업데이트하고, 다음으로 **테스트 기준**을 업데이트하며, 마지막에 **구현**한다.

### 5.2 변경 단계

1. SSOT 문서 수정

* 변경 대상 문서에 결정을 반영한다.
* 관련 문서 링크를 갱신한다.

2. 테스트 기준 수정

* 테스트 케이스, 체크리스트, 품질 게이트를 갱신한다.

3. 구현 반영

* UI, 로직, API를 SSOT 기준에 맞춰 수정한다.

4. 릴리즈 노트 반영

* 사용자에게 영향이 있는 변경은 릴리즈 노트에 반영한다.

---

## 6. 제품 약속(불변에 가까운 핵심)

TinyWords는 다음 약속을 최우선으로 한다.

* 사용자는 하루 3개를 기본으로 학습한다.
* 사용자는 설정으로 3-5개 범위에서 조정할 수 있다.
* 학습은 “암기량”이 아니라 “회상·문장·발화·복습”으로 완성된다.
* AI는 “학습을 쉽게 시작하게 해주는 도구”이며, 사용자의 실제 학습 행동(회상, 문장, 발화)을 대체하지 않는다.
* 오프라인 우선(offline-first) 철학을 따른다. 네트워크가 없어도 오늘 학습, 기록, 복습 확인은 가능해야 한다.
* UI는 과장된 그래픽과 과한 애니메이션을 지양하며, **너무 AI스럽지 않고 심플한 수첩 같은 느낌**을 기본 톤으로 유지한다.

---

## 7. 도메인 SSOT: 학습 단위 정의

### 7.1 Day Plan(하루 계획)

하루 계획은 TinyWords의 가장 중요한 단위이다.

* 날짜 단위로 생성·저장된다.
* 오늘 학습 항목 수는 `daily_target` 설정을 따른다.
* 하루 계획은 다음을 포함한다.

  * 오늘의 항목(3-5개)
  * 회상 체크(뜻 떠올리기)
  * 문장 생성(사용자 작성)
  * 발화(녹음, 발음 점수)
  * 완료 체크(스트릭 계산용)

### 7.2 Learning Item(학습 항목)

학습 항목은 “단어”만을 의미하지 않는다. 1차 MVP에서는 영어 중심이며 학습 포인트에 따라 형태가 바뀐다.

* 단어(`vocab`)
* 전치사(`preposition`)
* 숙어(`idiom`)
* 구동사(`phrasal_verb`)
* 콜로케이션(`collocation`)

항목은 사용자의 설정(레벨, 포인트)에 맞춰 AI가 생성한다. 사용자는 편집 및 교체가 가능해야 한다.

### 7.3 Mastery(내 것이 되었는가)

TinyWords에서 “내 것이 되었다”의 최소 정의는 아래 3단계의 누적이다.

1. 뜻을 가린 상태에서 회상 성공
2. 해당 항목을 포함한 문장을 사용자가 직접 작성
3. 그 문장을 실제로 발화(녹음)

발음 점수는 정확도를 보조적으로 보여주는 지표이며, 사용자의 회상·문장·발화 행동을 대체하지 않는다.

---

## 8. 도메인 SSOT: 복습 정책(개요)

복습 정책의 상세는 `11_SPACED_REVIEW_POLICY.md`가 정답이다. 이 문서에는 복습 철학과 최소 원칙만 정의한다.

* 신규 학습량이 적을수록 복습을 더 쉽게 포함할 수 있다.
* 복습은 재노출이 아니라 회상 중심이어야 한다.
* 기본 복습 슬롯은 D-1, D-3, D-7을 우선한다.
* 복습이 밀렸을 때는 가장 오래된 복습을 먼저 노출한다.

---

## 9. 도메인 SSOT: 스트릭 규칙(개요)

스트릭 상세는 `12_STREAK_RULES.md`가 정답이다. 이 문서에는 최소 원칙만 정의한다.

* 스트릭은 하루 계획 완료로만 유지된다.
* 보너스 활동(추가 항목, 추가 문장)은 스트릭 유지 조건이 아니다.
* 하루 계획 완료는 필수 체크가 모두 만족될 때 성립한다.

---

## 10. AI SSOT: 프롬프트 운영 원칙

AI 관련 상세 프롬프트는 각 문서가 정답이다.

* 단어/학습 항목 생성: `09_AI_WORD_GENERATION_PROMPT.md`
* 문장 코칭: `10_AI_SENTENCE_COACH_PROMPT.md`

이 문서에서는 운영 원칙만 정의한다.

* AI는 결과를 제안한다. 사용자는 교체 및 편집이 가능하다.
* AI 출력은 구조화된 JSON 스키마를 따른다(서버에서 검증 가능해야 한다).
* AI 비용 통제를 위해 생성은 하루 1회 기본을 원칙으로 한다. 재생성은 사용자 행동(교체, 설정 변경)에 의해 명시적으로 발생한다.
* 프롬프트는 앱 버전과 함께 버전 관리된다.

---

## 11. 음성/발음 SSOT: 제품 정의

### 11.1 녹음

* 사용자는 문장을 발화하며 녹음할 수 있다.
* 녹음은 하루 계획 단위로 저장된다.
* 녹음 파일은 로컬 저장이 기본이다.
* 동기화 기능이 추가되면 사용자가 명시적으로 업로드를 허용하는 흐름을 가진다.

### 11.2 발음 점수

발음 점수 상세는 `14_PRONUNCIATION_SCORING_SPEC.md`가 정답이다.

* 점수는 사용자를 평가하기 위한 것이 아니라 피드백을 통한 반복을 돕기 위한 지표이다.
* 점수는 문장 단위로 제공한다.
* 점수 표시 UX는 압박감을 줄이지 않도록 다음 행동 중심으로 제공한다.

---

## 12. 보안/개인정보 SSOT(핵심)

상세는 `16_SECURITY_PRIVACY_KEYS.md`가 정답이다.

* AI API 키는 클라이언트에 포함하지 않는다.
* 발음 점수 산출도 서버를 통해 호출하는 방식을 우선한다.
* 로컬 데이터는 기기 내 저장이 기본이며, 사용자 동의 없이 외부 전송하지 않는다.
* 로그에는 사용자 문장 원문 및 음성 파일 원본이 무심코 포함되지 않아야 한다.

---

## 13. 멀티플랫폼 SSOT(전략)

상세는 `18_PLATFORM_PACKAGING.md`가 정답이다.

* 단일 코드베이스(웹 기반)를 우선한다.
* iOS·iPadOS·Android는 네이티브 패키징을 통해 스토어 배포를 목표로 한다.
* macOS는 iPad 앱 실행 전략을 1차로 고려한다. 데스크톱 전용 경험이 필요해지면 별도 타깃(Electron 계열)을 추가한다.

---

## 14. 문서 품질 기준

SSOT 문서는 구현자가 바로 행동할 수 있어야 한다.

* 결정은 모호한 문장을 금지한다.
* 상태(state)와 에러(error) 케이스를 포함한다.
* 입력 필드의 제약(최대 길이, 필수/선택)을 명시한다.
* 계산 로직(스트릭, 복습 스케줄)은 의사코드 수준이라도 명확히 적는다.

---

## 15. 용어집

* **SSOT**: Single Source of Truth, 정답이 되는 유일한 기준 문서 체계
* **Day Plan**: 날짜 단위 학습 계획
* **Learning Item**: 오늘 학습하는 항목(단어, 전치사 등)
* **Recall**: 뜻을 가린 상태에서 떠올리기
* **Spaced Review**: 일정 간격을 두고 회상 중심으로 복습하는 정책
* **Streak**: 연속 학습일
* **Pronunciation Scoring**: 문장 발화의 발음 정확도, 유창성 등을 점수화한 피드백

---

## 16. 다음 작성 순서(권장)

SSOT를 기반으로 아래 문서들을 순서대로 작성하는 것이 가장 빠르다.

1. `02_MVP_SCOPE.md`
2. `04_DATA_MODEL.md`
3. `11_SPACED_REVIEW_POLICY.md`
4. `12_STREAK_RULES.md`
5. `09_AI_WORD_GENERATION_PROMPT.md`
6. `10_AI_SENTENCE_COACH_PROMPT.md`
7. `15_API_CONTRACT.md`
8. `17_UI_STYLE_NOTEBOOK_THEME.md`

이 순서를 따르면 구현을 시작할 때 요구사항 충돌이 크게 줄어든다.
