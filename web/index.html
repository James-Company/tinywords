<!doctype html>
<html lang="ko">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
    <title>TinyWords</title>
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>📝</text></svg>" />
    <link rel="manifest" href="/manifest.json" />
    <meta name="theme-color" content="#6E5B45" />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="default" />
    <meta name="apple-mobile-web-app-title" content="TinyWords" />
    <link rel="apple-touch-icon" href="/icons/icon-192x192.png" />
    <link rel="stylesheet" href="/styles.css" />
    <script src="/lib/lottie_light.min.js"></script>
  </head>
  <body>
    <!-- ═══ Splash (세션 확인 중) ═══ -->
    <div id="splash-screen" class="splash-screen">
      <div class="splash-content">
        <p class="splash-tagline-ko">조금씩 계속</p>
        <div id="splash-lottie" class="splash-lottie"></div>
        <h1 class="splash-brand">TinyWords</h1>
      </div>
    </div>

    <!-- ═══ Auth Screen ═══ -->
    <div id="auth-screen" class="auth-screen hidden">
      <div class="auth-container">
        <div class="auth-header">
          <h1 class="brand">TinyWords</h1>
          <p class="auth-tagline">하루 조금씩, 내 것으로</p>
        </div>

        <!-- Login Form (default) -->
        <form id="auth-login-form" class="auth-form" autocomplete="off">
          <div class="auth-field">
            <label for="login-email">이메일</label>
            <input type="email" id="login-email" placeholder="email@example.com" autocomplete="email" required />
          </div>
          <div class="auth-field">
            <label for="login-password">비밀번호</label>
            <input type="password" id="login-password" placeholder="8자 이상 (영문+숫자)" autocomplete="current-password" required />
          </div>
          <div id="login-error" class="auth-error hidden"></div>
          <button type="submit" class="btn btn-primary btn-block" id="login-submit-btn">로그인</button>

          <div class="auth-divider">
            <span>또는</span>
          </div>

          <button type="button" class="btn btn-google btn-block" id="google-login-btn">
            <svg width="18" height="18" viewBox="0 0 18 18" fill="none"><path d="M17.64 9.2c0-.637-.057-1.251-.164-1.84H9v3.481h4.844a4.14 4.14 0 01-1.796 2.716v2.259h2.908c1.702-1.567 2.684-3.875 2.684-6.615z" fill="#4285F4"/><path d="M9 18c2.43 0 4.467-.806 5.956-2.18l-2.908-2.259c-.806.54-1.837.86-3.048.86-2.344 0-4.328-1.584-5.036-3.711H.957v2.332A8.997 8.997 0 009 18z" fill="#34A853"/><path d="M3.964 10.71A5.41 5.41 0 013.682 9c0-.593.102-1.17.282-1.71V4.958H.957A8.997 8.997 0 000 9c0 1.452.348 2.827.957 4.042l3.007-2.332z" fill="#FBBC05"/><path d="M9 3.58c1.321 0 2.508.454 3.44 1.345l2.582-2.58C13.463.891 11.426 0 9 0A8.997 8.997 0 00.957 4.958L3.964 7.29C4.672 5.163 6.656 3.58 9 3.58z" fill="#EA4335"/></svg>
            Google로 계속하기
          </button>

          <div class="auth-links">
            <a href="#" id="forgot-password-link">비밀번호를 잊으셨나요?</a>
            <span class="auth-link-sep">·</span>
            <a href="#" id="show-signup-link">계정이 없으신가요? <strong>가입하기</strong></a>
          </div>
        </form>

        <!-- Signup Form (hidden) -->
        <form id="auth-signup-form" class="auth-form hidden" autocomplete="off">
          <div class="auth-field">
            <label for="signup-email">이메일</label>
            <input type="email" id="signup-email" placeholder="email@example.com" autocomplete="email" required />
          </div>
          <div class="auth-field">
            <label for="signup-password">비밀번호</label>
            <input type="password" id="signup-password" placeholder="8자 이상 (영문+숫자)" autocomplete="new-password" required />
          </div>
          <div class="auth-field">
            <label for="signup-password-confirm">비밀번호 확인</label>
            <input type="password" id="signup-password-confirm" placeholder="비밀번호를 다시 입력해주세요" autocomplete="new-password" required />
          </div>
          <div class="auth-terms">
            <label class="auth-checkbox-label auth-checkbox-all">
              <input type="checkbox" id="signup-agree-all" />
              <span>전체 동의</span>
            </label>
            <div class="auth-terms-divider"></div>
            <label class="auth-checkbox-label">
              <input type="checkbox" id="signup-terms" />
              <span><a href="#" data-legal="terms">이용약관</a>에 동의합니다. <em>(필수)</em></span>
            </label>
            <label class="auth-checkbox-label">
              <input type="checkbox" id="signup-privacy" />
              <span><a href="#" data-legal="privacy">개인정보처리방침</a>에 동의합니다. <em>(필수)</em></span>
            </label>
          </div>
          <div id="signup-error" class="auth-error hidden"></div>
          <button type="submit" class="btn btn-primary btn-block" id="signup-submit-btn" disabled>가입하기</button>

          <div class="auth-divider">
            <span>또는</span>
          </div>

          <button type="button" class="btn btn-google btn-block" id="google-signup-btn">
            <svg width="18" height="18" viewBox="0 0 18 18" fill="none"><path d="M17.64 9.2c0-.637-.057-1.251-.164-1.84H9v3.481h4.844a4.14 4.14 0 01-1.796 2.716v2.259h2.908c1.702-1.567 2.684-3.875 2.684-6.615z" fill="#4285F4"/><path d="M9 18c2.43 0 4.467-.806 5.956-2.18l-2.908-2.259c-.806.54-1.837.86-3.048.86-2.344 0-4.328-1.584-5.036-3.711H.957v2.332A8.997 8.997 0 009 18z" fill="#34A853"/><path d="M3.964 10.71A5.41 5.41 0 013.682 9c0-.593.102-1.17.282-1.71V4.958H.957A8.997 8.997 0 000 9c0 1.452.348 2.827.957 4.042l3.007-2.332z" fill="#FBBC05"/><path d="M9 3.58c1.321 0 2.508.454 3.44 1.345l2.582-2.58C13.463.891 11.426 0 9 0A8.997 8.997 0 00.957 4.958L3.964 7.29C4.672 5.163 6.656 3.58 9 3.58z" fill="#EA4335"/></svg>
            Google로 가입하기
          </button>

          <div class="auth-links">
            <a href="#" id="show-login-link">이미 계정이 있으신가요? <strong>로그인</strong></a>
          </div>
        </form>

        <!-- Password Reset Form (hidden) -->
        <form id="auth-reset-form" class="auth-form hidden" autocomplete="off">
          <p class="auth-reset-desc">가입하신 이메일을 입력하시면 비밀번호 재설정 링크를 보내드립니다.</p>
          <div class="auth-field">
            <label for="reset-email">이메일</label>
            <input type="email" id="reset-email" placeholder="email@example.com" autocomplete="email" required />
          </div>
          <div id="reset-error" class="auth-error hidden"></div>
          <div id="reset-success" class="auth-success hidden"></div>
          <button type="submit" class="btn btn-primary btn-block" id="reset-submit-btn">재설정 링크 보내기</button>
          <div class="auth-links">
            <a href="#" id="back-to-login-link">← 로그인으로 돌아가기</a>
          </div>
        </form>

        <!-- Email Confirmation Notice (hidden) -->
        <div id="auth-confirm-notice" class="auth-confirm-notice hidden">
          <div class="auth-confirm-icon">✉️</div>
          <h3>이메일을 확인해주세요</h3>
          <p>입력하신 이메일로 인증 링크를 보냈습니다. 메일함을 확인해주세요.</p>
          <div class="auth-links">
            <a href="#" id="back-to-login-from-confirm">로그인으로 돌아가기</a>
          </div>
        </div>
      </div>
    </div>

    <!-- ═══ Onboarding Screen (hidden until needed) ═══ -->
    <div id="onboarding-screen" class="onboarding-screen hidden">
      <div class="onboarding-container">
        <!-- Step indicators -->
        <div class="onboarding-progress" id="onboarding-progress"></div>

        <!-- Step 1: Welcome -->
        <div class="onboarding-step" id="onboarding-step-1">
          <div class="onboarding-welcome-icon">📝</div>
          <h1 class="onboarding-title">TinyWords</h1>
          <p class="onboarding-subtitle">매일 3-5개, 확실하게 내 것으로.</p>

          <div class="onboarding-feature-list">
            <div class="onboarding-feature">
              <span class="onboarding-feature-icon">🧠</span>
              <div>
                <strong>회상 중심 학습</strong>
                <p>"본 것"이 아니라 "떠올린 것"이 내 것이 됩니다.</p>
              </div>
            </div>
            <div class="onboarding-feature">
              <span class="onboarding-feature-icon">✍️</span>
              <div>
                <strong>문장으로 연결</strong>
                <p>단어를 직접 문장에 써보며 실전 감각을 키웁니다.</p>
              </div>
            </div>
            <div class="onboarding-feature">
              <span class="onboarding-feature-icon">🔁</span>
              <div>
                <strong>자동 복습</strong>
                <p>망각 곡선에 맞춰 복습이 자동으로 안내됩니다.</p>
              </div>
            </div>
          </div>

          <button class="btn btn-primary btn-block onboarding-next-btn" id="onboarding-start-btn">시작하기</button>
        </div>

        <!-- Step 2: Level Selection -->
        <div class="onboarding-step hidden" id="onboarding-step-2">
          <div class="onboarding-step-header">
            <span class="onboarding-step-label">STEP 1/3</span>
            <h2 class="onboarding-question">현재 영어 수준은 어느 정도인가요?</h2>
            <p class="onboarding-hint">수준에 맞는 단어를 AI가 추천해드려요.</p>
          </div>

          <div class="onboarding-options" id="level-options">
            <button class="onboarding-option-card" data-value="A1">
              <span class="option-label">A1 — 완전 초보</span>
              <span class="option-desc">apple, book 같은 기본 단어부터</span>
            </button>
            <button class="onboarding-option-card selected" data-value="A2">
              <span class="option-label">A2 — 기초</span>
              <span class="option-desc">일상 표현은 어느 정도 알아요</span>
            </button>
            <button class="onboarding-option-card" data-value="B1">
              <span class="option-label">B1 — 중급</span>
              <span class="option-desc">간단한 대화는 가능해요</span>
            </button>
            <button class="onboarding-option-card" data-value="B2">
              <span class="option-label">B2 — 중상급</span>
              <span class="option-desc">뉴스, 업무 영어도 이해해요</span>
            </button>
          </div>

          <div class="onboarding-nav">
            <button class="btn btn-secondary" id="onboarding-back-2">이전</button>
            <button class="btn btn-primary" id="onboarding-next-2">다음</button>
          </div>
        </div>

        <!-- Step 3: Learning Focus -->
        <div class="onboarding-step hidden" id="onboarding-step-3">
          <div class="onboarding-step-header">
            <span class="onboarding-step-label">STEP 2/3</span>
            <h2 class="onboarding-question">어떤 상황에서 영어를 쓰고 싶나요?</h2>
            <p class="onboarding-hint">상황에 맞는 단어를 우선 추천해드려요.</p>
          </div>

          <div class="onboarding-options" id="focus-options">
            <button class="onboarding-option-card selected" data-value="travel">
              <span class="option-label">✈️ 여행</span>
              <span class="option-desc">해외여행에서 자연스럽게</span>
            </button>
            <button class="onboarding-option-card" data-value="business">
              <span class="option-label">💼 업무</span>
              <span class="option-desc">회의, 이메일, 비즈니스</span>
            </button>
            <button class="onboarding-option-card" data-value="exam">
              <span class="option-label">📖 시험</span>
              <span class="option-desc">TOEIC, IELTS 등 시험 대비</span>
            </button>
            <button class="onboarding-option-card" data-value="general">
              <span class="option-label">🌍 일상</span>
              <span class="option-desc">넓고 다양한 생활 영어</span>
            </button>
          </div>

          <div class="onboarding-nav">
            <button class="btn btn-secondary" id="onboarding-back-3">이전</button>
            <button class="btn btn-primary" id="onboarding-next-3">다음</button>
          </div>
        </div>

        <!-- Step 4: Daily Target -->
        <div class="onboarding-step hidden" id="onboarding-step-4">
          <div class="onboarding-step-header">
            <span class="onboarding-step-label">STEP 3/3</span>
            <h2 class="onboarding-question">하루에 몇 개 단어를 학습할까요?</h2>
            <p class="onboarding-hint">처음이라면 3개부터 시작하는 걸 추천해요.</p>
          </div>

          <div class="onboarding-options" id="target-options">
            <button class="onboarding-option-card selected" data-value="3">
              <span class="option-label">3개</span>
              <span class="option-desc">약 3-5분 · 가볍게 시작</span>
            </button>
            <button class="onboarding-option-card" data-value="4">
              <span class="option-label">4개</span>
              <span class="option-desc">약 5-7분 · 적당한 속도</span>
            </button>
            <button class="onboarding-option-card" data-value="5">
              <span class="option-label">5개</span>
              <span class="option-desc">약 7-10분 · 빠르게 쌓기</span>
            </button>
          </div>

          <p class="onboarding-change-note">나중에 Settings에서 언제든 변경할 수 있어요.</p>

          <div class="onboarding-nav">
            <button class="btn btn-secondary" id="onboarding-back-4">이전</button>
            <button class="btn btn-primary" id="onboarding-complete-btn">첫 학습 시작하기</button>
          </div>
        </div>
      </div>
    </div>

    <!-- ═══ Main App (hidden until logged in) ═══ -->
    <main class="app hidden" id="main-app">
      <!-- Error / Offline banner -->
      <div id="error-banner" class="error-banner hidden"></div>

      <header class="header">
        <div class="header-top">
          <h1 class="brand">TinyWords</h1>
          <div class="streak-mini" id="streak-mini"></div>
        </div>
        <p class="sub"></p>
      </header>

      <nav class="tabs" role="tablist">
        <button data-tab="home" class="tab active" role="tab" aria-selected="true">홈</button>
        <button data-tab="today" class="tab" role="tab" aria-selected="false">Today</button>
        <button data-tab="inbox" class="tab" role="tab" aria-selected="false">Inbox</button>
        <button data-tab="history" class="tab" role="tab" aria-selected="false">History</button>
        <button data-tab="settings" class="tab" role="tab" aria-selected="false">Settings</button>
      </nav>

      <section id="home" class="panel" role="tabpanel"></section>
      <section id="today" class="panel hidden" role="tabpanel"></section>
      <section id="inbox" class="panel hidden" role="tabpanel"></section>
      <section id="history" class="panel hidden" role="tabpanel"></section>
      <section id="settings" class="panel hidden" role="tabpanel"></section>
    </main>

    <div id="toast" class="toast hidden"></div>
    <div id="modal-overlay" class="modal-overlay hidden">
      <div class="modal" id="modal-content"></div>
    </div>

    <!-- 약관/개인정보 모달 -->
    <div id="legal-modal-overlay" class="legal-modal-overlay hidden">
      <div class="legal-modal">
        <div class="legal-modal-header">
          <h2 id="legal-modal-title"></h2>
          <button class="legal-modal-close" id="legal-modal-close" aria-label="닫기">&times;</button>
        </div>
        <div class="legal-modal-body" id="legal-modal-body"></div>
      </div>
    </div>

    <script>
      window.__splashLottie = null;
      (function initSplashLottie() {
        var el = document.getElementById("splash-lottie");
        if (el && typeof lottie !== "undefined") {
          window.__splashLottie = lottie.loadAnimation({
            container: el,
            renderer: "svg",
            loop: true,
            autoplay: true,
            path: "/lottie/splash.json"
          });
        }
      })();
    </script>
    <script type="module" src="/app.js"></script>
  </body>
</html>
